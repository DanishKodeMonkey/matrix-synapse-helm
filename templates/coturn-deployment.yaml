apiVersion: apps/v1
kind: Deployment
metadata:
  name: coturn
spec:
  replicas: 1
  selector:
    matchLabels:
      app: coturn
  template:
    metadata:
      labels:
        app: coturn
    spec:
      hostNetwork: true
      dnsPolicy: ClusterFirstWithHostNet
      containers:
        - name: coturn
          image: coturn/coturn:latest
          args:
            - -c
            - /etc/coturn/turnserver.conf
          volumeMounts:
            - name: config
              mountPath: /etc/coturn/turnserver.conf
              subPath: turnserver.conf
            - name: coturn-tls
              mountPath: /etc/coturn/tls
              readOnly: true

      volumes:
        - name: config
          configMap:
            name: coturn-config
        - name: coturn-tls
          secret:
            secretName: coturn-tls-secret